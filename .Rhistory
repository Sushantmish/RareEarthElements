if(length(normalised_values)>1)
{
for(i in 2:length(normalised_values))
{
lines(1:length(reference_values),normalised_values[[i]],type="b",col=colors[i])
}
}
}
samples <- list(ree_sample1,ree_sample2,ree_sample3,ree_sample4,ree_sample5,ree_sample6,ree_sample7,ree_sample8,ree_sample9,ree_sample10,ree_sample11,ree_sample12,ree_sample13)
plot_spider(samples, ree_ref,main = "REE Spider Diagram (Sample 19, Reference: m&s )")
#downloading dataset
adakite <- read.csv(file = 'Data/ADAKITE.csv')
alkali_basalt <- read.csv(file = 'Data/ALKALI_BASALT.csv')
andesite <- read.csv(file='Data/ANDESITE.csv')
anakaramite <- read.csv(file='Data/ANKARAMITE.csv')
basalt <- read.csv(file = 'Data/BASALT.csv')
dolerite <- read.csv(file='Data/DOLERITE.csv')
gabbro <- read.csv(file='Data/GABBRO.csv')
granite <- read.csv(file='Data/GRANITE.csv')
hawaiite <- read.csv(file='Data/HAWAIITE.csv')
kimberlite <- read.csv(file='Data/KIMBERLITE.csv')
peridotite <-read.csv(file='Data/PERIDOTITE.csv')
pyroxenite <-read.csv(file='Data/PYROXENITE.csv')
rhyolite <-read.csv(file='Data/RHYOLITE.csv')
ref <- read.csv(file='Data/Normalised Values.csv')
# gathering REE data from sample
ree_sample1 <- as.numeric(adakite[19, 119:132])
ree_sample2 <- as.numeric(alkali_basalt[20, 119:132])
ree_sample3 <- as.numeric(andesite[7, 119:132])
ree_sample4 <- as.numeric(anakaramite[80, 119:132])
ree_sample5 <- as.numeric(basalt[20, 119:132])
ree_sample6 <- as.numeric(dolerite[20, 119:132])
ree_sample7 <- as.numeric(gabbro[20, 119:132])
ree_sample8 <- as.numeric(granite[20, 119:132])
ree_sample9 <- as.numeric(hawaiite[19, 119:132])
ree_sample10 <- as.numeric(kimberlite[20, 119:132])
ree_sample11 <- as.numeric(peridotite[10, 119:132])
ree_sample12 <- as.numeric(pyroxenite[20, 119:132])
ree_sample13 <- as.numeric(rhyolite[20, 119:132])
# taking reference values
ree_ref <- as.numeric(ref[3:16, 14]) #column 4,5 dont work
colors <- c("black","red","yellow","lightblue","green","orange","pink","cyan","purple","brown","gold","violet","navy")
rock_names <- c("adakite","alkali_basalt","andesite","anakaramite","basalt","dolerite","gabbro","granite","hawaiite","kimberlite","peridotite","pyroxenite","rhyolite")
#this is a function for plotting spider plots for REE data
plot_spider <- function(samples,reference_values,logscale=TRUE,colors=NULL,main= "Spider Plot for Normalised REE Values",xlab="Rare Earth Elements",ylab ="Normalised values")
{
# these are the REE we will be covering generally
REE_symbols <-  c("La","Ce","Pr","Nd","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu")
if (is.null(colors))
{
colors <- c("black","red","yellow","lightblue","green","orange","pink","cyan","purple","brown","gold","violet","navy")
}
# normalising values of samples with the reference set
normalised_values <- lapply(samples,function(s1) as.numeric(s1)/as.numeric(reference_values))
#axis range
ymin <- if (logscale) min(unlist(normalised_values), na.rm = TRUE) else 0
ymax <- max(unlist(normalised_values), na.rm = TRUE)
# generate plot
plot(1:length(reference_values),normalised_values[[1]],type="b",xaxt="n",,xlab="Rare Earth Elements",ylab ="Concentration",log = 'y',ylim = c(ymin, ymax),col=colors[1])
axis(1,at=1:length(reference_values),labels = REE_symbols)
grid(nx=NULL, ny=NULL,col="gray",lwd=1)
abline(h=1,col="black",lwd=3)
# generate other plots
if(length(normalised_values)>1)
{
for(i in 2:length(normalised_values))
{
lines(1:length(reference_values),normalised_values[[i]],type="b",col=colors[i])
}
}
legend("topright", legend = rock_names, col = colors[1:length(samples)], lty = 1, lwd = 2, bty = "n")
}
samples <- list(ree_sample1,ree_sample2,ree_sample3,ree_sample4,ree_sample5,ree_sample6,ree_sample7,ree_sample8,ree_sample9,ree_sample10,ree_sample11,ree_sample12,ree_sample13)
plot_spider(samples, ree_ref,main = "REE Spider Diagram (Sample 19, Reference: m&s )")
#this is a function for plotting spider plots for REE data
plot_spider <- function(samples,reference_values,logscale=TRUE,colors=NULL,main= "Spider Plot for Normalised REE Values",xlab="Rare Earth Elements",ylab ="Normalised values")
{
# these are the REE we will be covering generally
REE_symbols <-  c("La","Ce","Pr","Nd","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu")
if (is.null(colors))
{
colors <- c("black","red","yellow","lightblue","green","orange","pink","cyan","purple","brown","gold","violet","navy")
}
# normalising values of samples with the reference set
normalised_values <- lapply(samples,function(s1) as.numeric(s1)/as.numeric(reference_values))
#axis range
ymin <- if (logscale) min(unlist(normalised_values), na.rm = TRUE) else 0
ymax <- max(unlist(normalised_values), na.rm = TRUE)
# generate plot
plot(1:length(reference_values),normalised_values[[1]],type="b",xaxt="n",,xlab="Rare Earth Elements",ylab ="Concentration",log = 'y',ylim = c(ymin, ymax),col=colors[1])
axis(1,at=1:length(reference_values),labels = REE_symbols)
grid(nx=NULL, ny=NULL,col="gray",lwd=1)
abline(h=1,col="black",lwd=3)
# generate other plots
if(length(normalised_values)>1)
{
for(i in 2:length(normalised_values))
{
lines(1:length(reference_values),normalised_values[[i]],type="b",col=colors[i])
}
}
legend("top", legend = rock_names, col = colors[1:length(samples)], lty = 1, lwd = 2, bty = "n")
}
samples <- list(ree_sample1,ree_sample2,ree_sample3,ree_sample4,ree_sample5,ree_sample6,ree_sample7,ree_sample8,ree_sample9,ree_sample10,ree_sample11,ree_sample12,ree_sample13)
#downloading dataset
adakite <- read.csv(file = 'Data/ADAKITE.csv')
alkali_basalt <- read.csv(file = 'Data/ALKALI_BASALT.csv')
andesite <- read.csv(file='Data/ANDESITE.csv')
anakaramite <- read.csv(file='Data/ANKARAMITE.csv')
basalt <- read.csv(file = 'Data/BASALT.csv')
dolerite <- read.csv(file='Data/DOLERITE.csv')
gabbro <- read.csv(file='Data/GABBRO.csv')
granite <- read.csv(file='Data/GRANITE.csv')
hawaiite <- read.csv(file='Data/HAWAIITE.csv')
kimberlite <- read.csv(file='Data/KIMBERLITE.csv')
peridotite <-read.csv(file='Data/PERIDOTITE.csv')
pyroxenite <-read.csv(file='Data/PYROXENITE.csv')
rhyolite <-read.csv(file='Data/RHYOLITE.csv')
ref <- read.csv(file='Data/Normalised Values.csv')
# gathering REE data from sample
ree_sample1 <- as.numeric(adakite[19, 119:132])
ree_sample2 <- as.numeric(alkali_basalt[20, 119:132])
ree_sample3 <- as.numeric(andesite[7, 119:132])
ree_sample4 <- as.numeric(anakaramite[80, 119:132])
ree_sample5 <- as.numeric(basalt[20, 119:132])
ree_sample6 <- as.numeric(dolerite[20, 119:132])
ree_sample7 <- as.numeric(gabbro[20, 119:132])
ree_sample8 <- as.numeric(granite[20, 119:132])
ree_sample9 <- as.numeric(hawaiite[19, 119:132])
ree_sample10 <- as.numeric(kimberlite[20, 119:132])
ree_sample11 <- as.numeric(peridotite[10, 119:132])
ree_sample12 <- as.numeric(pyroxenite[20, 119:132])
ree_sample13 <- as.numeric(rhyolite[20, 119:132])
# taking reference values
ree_ref <- as.numeric(ref[3:16, 14]) #column 4,5 dont work
colors <- c("black","red","yellow","lightblue","green","orange","pink","cyan","purple","brown","gold","violet","navy")
rock_names <- c("adakite","alkali_basalt","andesite","anakaramite","basalt","dolerite","gabbro","granite","hawaiite","kimberlite","peridotite","pyroxenite","rhyolite")
#this is a function for plotting spider plots for REE data
plot_spider <- function(samples,reference_values,logscale=TRUE,colors=NULL,main= "Spider Plot for Normalised REE Values",xlab="Rare Earth Elements",ylab ="Normalised values")
{
# these are the REE we will be covering generally
REE_symbols <-  c("La","Ce","Pr","Nd","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu")
if (is.null(colors))
{
colors <- c("black","red","yellow","lightblue","green","orange","pink","cyan","purple","brown","gold","violet","navy")
}
# normalising values of samples with the reference set
normalised_values <- lapply(samples,function(s1) as.numeric(s1)/as.numeric(reference_values))
#axis range
ymin <- if (logscale) min(unlist(normalised_values), na.rm = TRUE) else 0
ymax <- max(unlist(normalised_values), na.rm = TRUE)
# generate plot
plot(1:length(reference_values),normalised_values[[1]],type="b",xaxt="n",,xlab="Rare Earth Elements",ylab ="Concentration",log = 'y',ylim = c(ymin, ymax),col=colors[1])
axis(1,at=1:length(reference_values),labels = REE_symbols)
grid(nx=NULL, ny=NULL,col="gray",lwd=1)
abline(h=1,col="black",lwd=3)
# generate other plots
if(length(normalised_values)>1)
{
for(i in 2:length(normalised_values))
{
lines(1:length(reference_values),normalised_values[[i]],type="b",col=colors[i])
}
}
legend("top", legend = rock_names, col = colors[1:length(samples)], lty = 1, lwd = 2, bty = "n")
}
samples <- list(ree_sample1,ree_sample2,ree_sample3,ree_sample4,ree_sample5,ree_sample6,ree_sample7,ree_sample8,ree_sample9,ree_sample10,ree_sample11,ree_sample12,ree_sample13)
plot_spider(samples, ree_ref,main = "REE Spider Diagram (Sample 19, Reference: m&s )")
#this is a function for plotting spider plots for REE data
plot_spider <- function(samples,reference_values,logscale=TRUE,colors=NULL,main= "Spider Plot for Normalised REE Values",xlab="Rare Earth Elements",ylab ="Normalised values")
{
# these are the REE we will be covering generally
REE_symbols <-  c("La","Ce","Pr","Nd","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu")
if (is.null(colors))
{
colors <- c("black","red","yellow","lightblue","green","orange","pink","cyan","purple","brown","gold","violet","navy")
}
# normalising values of samples with the reference set
normalised_values <- lapply(samples,function(s1) as.numeric(s1)/as.numeric(reference_values))
#axis range
ymin <- if (logscale) min(unlist(normalised_values), na.rm = TRUE) else 0
ymax <- max(unlist(normalised_values), na.rm = TRUE)
# generate plot
plot(1:length(reference_values),normalised_values[[1]],type="b",xaxt="n",,xlab="Rare Earth Elements",ylab ="Concentration",log = 'y',ylim = c(ymin, ymax),col=colors[1])
axis(1,at=1:length(reference_values),labels = REE_symbols)
grid(nx=NULL, ny=NULL,col="gray",lwd=1)
abline(h=1,col="black",lwd=3)
# generate other plots
if(length(normalised_values)>1)
{
for(i in 2:length(normalised_values))
{
lines(1:length(reference_values),normalised_values[[i]],type="b",col=colors[i])
}
}
legend("top", legend = rock_names, col = colors[1:length(samples)], lty = 1, lwd = 2, bty = "n",xpd = TRUE)
}
samples <- list(ree_sample1,ree_sample2,ree_sample3,ree_sample4,ree_sample5,ree_sample6,ree_sample7,ree_sample8,ree_sample9,ree_sample10,ree_sample11,ree_sample12,ree_sample13)
plot_spider(samples, ree_ref,main = "REE Spider Diagram (Sample 19, Reference: m&s )")
#this is a function for plotting spider plots for REE data
plot_spider <- function(samples,reference_values,logscale=TRUE,colors=NULL,main= "Spider Plot for Normalised REE Values",xlab="Rare Earth Elements",ylab ="Normalised values")
{
# these are the REE we will be covering generally
REE_symbols <-  c("La","Ce","Pr","Nd","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu")
if (is.null(colors))
{
colors <- c("black","red","yellow","lightblue","green","orange","pink","cyan","purple","brown","gold","violet","navy")
}
# normalising values of samples with the reference set
normalised_values <- lapply(samples,function(s1) as.numeric(s1)/as.numeric(reference_values))
#axis range
ymin <- if (logscale) min(unlist(normalised_values), na.rm = TRUE) else 0
ymax <- max(unlist(normalised_values), na.rm = TRUE)
# generate plot
plot(1:length(reference_values),normalised_values[[1]],type="b",xaxt="n",,xlab="Rare Earth Elements",ylab ="Concentration",log = 'y',ylim = c(ymin, ymax),col=colors[1])
axis(1,at=1:length(reference_values),labels = REE_symbols)
grid(nx=NULL, ny=NULL,col="gray",lwd=1)
abline(h=1,col="black",lwd=3)
# generate other plots
if(length(normalised_values)>1)
{
for(i in 2:length(normalised_values))
{
lines(1:length(reference_values),normalised_values[[i]],type="b",col=colors[i])
}
}
legend("top", legend = rock_names, col = colors[1:length(samples)], lty = 1, lwd = 2, bty = "n",xpd = TRUE,inset = -0.4,0)
}
samples <- list(ree_sample1,ree_sample2,ree_sample3,ree_sample4,ree_sample5,ree_sample6,ree_sample7,ree_sample8,ree_sample9,ree_sample10,ree_sample11,ree_sample12,ree_sample13)
plot_spider(samples, ree_ref,main = "REE Spider Diagram (Sample 19, Reference: m&s )")
#this is a function for plotting spider plots for REE data
plot_spider <- function(samples,reference_values,logscale=TRUE,colors=NULL,main= "Spider Plot for Normalised REE Values",xlab="Rare Earth Elements",ylab ="Normalised values")
{
# these are the REE we will be covering generally
REE_symbols <-  c("La","Ce","Pr","Nd","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu")
if (is.null(colors))
{
colors <- c("black","red","yellow","lightblue","green","orange","pink","cyan","purple","brown","gold","violet","navy")
}
# normalising values of samples with the reference set
normalised_values <- lapply(samples,function(s1) as.numeric(s1)/as.numeric(reference_values))
#axis range
ymin <- if (logscale) min(unlist(normalised_values), na.rm = TRUE) else 0
ymax <- max(unlist(normalised_values), na.rm = TRUE)
# generate plot
plot(1:length(reference_values),normalised_values[[1]],type="b",xaxt="n",,xlab="Rare Earth Elements",ylab ="Concentration",log = 'y',ylim = c(ymin, ymax),col=colors[1])
axis(1,at=1:length(reference_values),labels = REE_symbols)
grid(nx=NULL, ny=NULL,col="gray",lwd=1)
abline(h=1,col="black",lwd=3)
# generate other plots
if(length(normalised_values)>1)
{
for(i in 2:length(normalised_values))
{
lines(1:length(reference_values),normalised_values[[i]],type="b",col=colors[i])
}
}
legend("top", legend = rock_names, col = colors[1:length(samples)], lty = 1, lwd = 2, bty = "n",xpd = TRUE,inset = ,0.5)
}
samples <- list(ree_sample1,ree_sample2,ree_sample3,ree_sample4,ree_sample5,ree_sample6,ree_sample7,ree_sample8,ree_sample9,ree_sample10,ree_sample11,ree_sample12,ree_sample13)
plot_spider(samples, ree_ref,main = "REE Spider Diagram (Sample 19, Reference: m&s )")
#this is a function for plotting spider plots for REE data
plot_spider <- function(samples,reference_values,logscale=TRUE,colors=NULL,main= "Spider Plot for Normalised REE Values",xlab="Rare Earth Elements",ylab ="Normalised values")
{
# these are the REE we will be covering generally
REE_symbols <-  c("La","Ce","Pr","Nd","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu")
if (is.null(colors))
{
colors <- c("black","red","yellow","lightblue","green","orange","pink","cyan","purple","brown","gold","violet","navy")
}
# normalising values of samples with the reference set
normalised_values <- lapply(samples,function(s1) as.numeric(s1)/as.numeric(reference_values))
#axis range
ymin <- if (logscale) min(unlist(normalised_values), na.rm = TRUE) else 0
ymax <- max(unlist(normalised_values), na.rm = TRUE)
# generate plot
plot(1:length(reference_values),normalised_values[[1]],type="b",xaxt="n",,xlab="Rare Earth Elements",ylab ="Concentration",log = 'y',ylim = c(ymin, ymax),col=colors[1])
axis(1,at=1:length(reference_values),labels = REE_symbols)
grid(nx=NULL, ny=NULL,col="gray",lwd=1)
abline(h=1,col="black",lwd=3)
# generate other plots
if(length(normalised_values)>1)
{
for(i in 2:length(normalised_values))
{
lines(1:length(reference_values),normalised_values[[i]],type="b",col=colors[i])
}
}
legend("top", legend = rock_names, col = colors[1:length(samples)], lty = 1, lwd = 2, bty = "n",xpd = TRUE,inset = ,-0.5)
}
samples <- list(ree_sample1,ree_sample2,ree_sample3,ree_sample4,ree_sample5,ree_sample6,ree_sample7,ree_sample8,ree_sample9,ree_sample10,ree_sample11,ree_sample12,ree_sample13)
plot_spider(samples, ree_ref,main = "REE Spider Diagram (Sample 19, Reference: m&s )")
#this is a function for plotting spider plots for REE data
plot_spider <- function(samples,reference_values,logscale=TRUE,colors=NULL,main= "Spider Plot for Normalised REE Values",xlab="Rare Earth Elements",ylab ="Normalised values")
{
# these are the REE we will be covering generally
REE_symbols <-  c("La","Ce","Pr","Nd","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu")
if (is.null(colors))
{
colors <- c("black","red","yellow","lightblue","green","orange","pink","cyan","purple","brown","gold","violet","navy")
}
# normalising values of samples with the reference set
normalised_values <- lapply(samples,function(s1) as.numeric(s1)/as.numeric(reference_values))
#axis range
ymin <- if (logscale) min(unlist(normalised_values), na.rm = TRUE) else 0
ymax <- max(unlist(normalised_values), na.rm = TRUE)
# generate plot
plot(1:length(reference_values),normalised_values[[1]],type="b",xaxt="n",,xlab="Rare Earth Elements",ylab ="Concentration",log = 'y',ylim = c(ymin, ymax),col=colors[1])
axis(1,at=1:length(reference_values),labels = REE_symbols)
grid(nx=NULL, ny=NULL,col="gray",lwd=1)
abline(h=1,col="black",lwd=3)
# generate other plots
if(length(normalised_values)>1)
{
for(i in 2:length(normalised_values))
{
lines(1:length(reference_values),normalised_values[[i]],type="b",col=colors[i])
}
}
legend("top", legend = rock_names, col = colors[1:length(samples)], lty = 1, lwd = 2, bty = "n",xpd = TRUE,inset = ,-0.5)
}
samples <- list(ree_sample1,ree_sample2,ree_sample3,ree_sample4,ree_sample5,ree_sample6,ree_sample7,ree_sample8,ree_sample9,ree_sample10,ree_sample11,ree_sample12,ree_sample13)
plot_spider(samples, ree_ref,main = "REE Spider Diagram (Sample 19, Reference: m&s )")
#this is a function for plotting spider plots for REE data
plot_spider <- function(samples,reference_values,logscale=TRUE,colors=NULL,main= "Spider Plot for Normalised REE Values",xlab="Rare Earth Elements",ylab ="Normalised values")
{
# these are the REE we will be covering generally
REE_symbols <-  c("La","Ce","Pr","Nd","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu")
if (is.null(colors))
{
colors <- c("black","red","yellow","lightblue","green","orange","pink","cyan","purple","brown","gold","violet","navy")
}
# normalising values of samples with the reference set
normalised_values <- lapply(samples,function(s1) as.numeric(s1)/as.numeric(reference_values))
#axis range
ymin <- if (logscale) min(unlist(normalised_values), na.rm = TRUE) else 0
ymax <- max(unlist(normalised_values), na.rm = TRUE)
# generate plot
plot(1:length(reference_values),normalised_values[[1]],type="b",xaxt="n",,xlab="Rare Earth Elements",ylab ="Concentration",log = 'y',ylim = c(ymin, ymax),col=colors[1])
axis(1,at=1:length(reference_values),labels = REE_symbols)
grid(nx=NULL, ny=NULL,col="gray",lwd=1)
abline(h=1,col="black",lwd=3)
# generate other plots
if(length(normalised_values)>1)
{
for(i in 2:length(normalised_values))
{
lines(1:length(reference_values),normalised_values[[i]],type="b",col=colors[i])
}
}
legend("right", legend = rock_names, col = colors[1:length(samples)], lty = 1, lwd = 2, bty = "n",xpd = TRUE,inset = ,0)
}
samples <- list(ree_sample1,ree_sample2,ree_sample3,ree_sample4,ree_sample5,ree_sample6,ree_sample7,ree_sample8,ree_sample9,ree_sample10,ree_sample11,ree_sample12,ree_sample13)
plot_spider(samples, ree_ref,main = "REE Spider Diagram (Sample 19, Reference: m&s )")
#this is a function for plotting spider plots for REE data
plot_spider <- function(samples,reference_values,logscale=TRUE,colors=NULL,main= "Spider Plot for Normalised REE Values",xlab="Rare Earth Elements",ylab ="Normalised values")
{
# these are the REE we will be covering generally
REE_symbols <-  c("La","Ce","Pr","Nd","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu")
if (is.null(colors))
{
colors <- c("black","red","yellow","lightblue","green","orange","pink","cyan","purple","brown","gold","violet","navy")
}
# normalising values of samples with the reference set
normalised_values <- lapply(samples,function(s1) as.numeric(s1)/as.numeric(reference_values))
#axis range
ymin <- if (logscale) min(unlist(normalised_values), na.rm = TRUE) else 0
ymax <- max(unlist(normalised_values), na.rm = TRUE)
# generate plot
plot(1:length(reference_values),normalised_values[[1]],type="b",xaxt="n",,xlab="Rare Earth Elements",ylab ="Concentration",log = 'y',ylim = c(ymin, ymax),col=colors[1])
axis(1,at=1:length(reference_values),labels = REE_symbols)
grid(nx=NULL, ny=NULL,col="gray",lwd=1)
abline(h=1,col="black",lwd=3)
# generate other plots
if(length(normalised_values)>1)
{
for(i in 2:length(normalised_values))
{
lines(1:length(reference_values),normalised_values[[i]],type="b",col=colors[i])
}
}
legend("right", legend = rock_names, col = colors[1:length(samples)], lty = 1, lwd = 2, bty = "n",xpd = TRUE,inset = 0,0.5)
}
samples <- list(ree_sample1,ree_sample2,ree_sample3,ree_sample4,ree_sample5,ree_sample6,ree_sample7,ree_sample8,ree_sample9,ree_sample10,ree_sample11,ree_sample12,ree_sample13)
plot_spider(samples, ree_ref,main = "REE Spider Diagram (Sample 19, Reference: m&s )")
#this is a function for plotting spider plots for REE data
plot_spider <- function(samples,reference_values,logscale=TRUE,colors=NULL,main= "Spider Plot for Normalised REE Values",xlab="Rare Earth Elements",ylab ="Normalised values")
{
# these are the REE we will be covering generally
REE_symbols <-  c("La","Ce","Pr","Nd","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu")
if (is.null(colors))
{
colors <- c("black","red","yellow","lightblue","green","orange","pink","cyan","purple","brown","gold","violet","navy")
}
# normalising values of samples with the reference set
normalised_values <- lapply(samples,function(s1) as.numeric(s1)/as.numeric(reference_values))
#axis range
ymin <- if (logscale) min(unlist(normalised_values), na.rm = TRUE) else 0
ymax <- max(unlist(normalised_values), na.rm = TRUE)
# generate plot
plot(1:length(reference_values),normalised_values[[1]],type="b",xaxt="n",,xlab="Rare Earth Elements",ylab ="Concentration",log = 'y',ylim = c(ymin, ymax),col=colors[1])
axis(1,at=1:length(reference_values),labels = REE_symbols)
grid(nx=NULL, ny=NULL,col="gray",lwd=1)
abline(h=1,col="black",lwd=3)
# generate other plots
if(length(normalised_values)>1)
{
for(i in 2:length(normalised_values))
{
lines(1:length(reference_values),normalised_values[[i]],type="b",col=colors[i])
}
}
legend("right", legend = rock_names, col = colors[1:length(samples)], lty = 1, lwd = 2, bty = "n",xpd = TRUE,inset = 0,-0.5)
}
samples <- list(ree_sample1,ree_sample2,ree_sample3,ree_sample4,ree_sample5,ree_sample6,ree_sample7,ree_sample8,ree_sample9,ree_sample10,ree_sample11,ree_sample12,ree_sample13)
plot_spider(samples, ree_ref,main = "REE Spider Diagram (Sample 19, Reference: m&s )")
#this is a function for plotting spider plots for REE data
plot_spider <- function(samples,reference_values,logscale=TRUE,colors=NULL,main= "Spider Plot for Normalised REE Values",xlab="Rare Earth Elements",ylab ="Normalised values")
{
# these are the REE we will be covering generally
REE_symbols <-  c("La","Ce","Pr","Nd","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu")
if (is.null(colors))
{
colors <- c("black","red","yellow","lightblue","green","orange","pink","cyan","purple","brown","gold","violet","navy")
}
# normalising values of samples with the reference set
normalised_values <- lapply(samples,function(s1) as.numeric(s1)/as.numeric(reference_values))
#axis range
ymin <- if (logscale) min(unlist(normalised_values), na.rm = TRUE) else 0
ymax <- max(unlist(normalised_values), na.rm = TRUE)
# generate plot
plot(1:length(reference_values),normalised_values[[1]],type="b",xaxt="n",,xlab="Rare Earth Elements",ylab ="Concentration",log = 'y',ylim = c(ymin, ymax),col=colors[1])
axis(1,at=1:length(reference_values),labels = REE_symbols)
grid(nx=NULL, ny=NULL,col="gray",lwd=1)
abline(h=1,col="black",lwd=3)
# generate other plots
if(length(normalised_values)>1)
{
for(i in 2:length(normalised_values))
{
lines(1:length(reference_values),normalised_values[[i]],type="b",col=colors[i])
}
}
legend("right", legend = rock_names, col = colors[1:length(samples)], lty = 1, lwd = 2, bty = "n",xpd = TRUE,inset = -0.5,0)
}
samples <- list(ree_sample1,ree_sample2,ree_sample3,ree_sample4,ree_sample5,ree_sample6,ree_sample7,ree_sample8,ree_sample9,ree_sample10,ree_sample11,ree_sample12,ree_sample13)
plot_spider(samples, ree_ref,main = "REE Spider Diagram (Sample 19, Reference: m&s )")
#downloading dataset
adakite <- read.csv(file = 'Data/ADAKITE.csv')
alkali_basalt <- read.csv(file = 'Data/ALKALI_BASALT.csv')
andesite <- read.csv(file='Data/ANDESITE.csv')
anakaramite <- read.csv(file='Data/ANKARAMITE.csv')
basalt <- read.csv(file = 'Data/BASALT.csv')
dolerite <- read.csv(file='Data/DOLERITE.csv')
gabbro <- read.csv(file='Data/GABBRO.csv')
granite <- read.csv(file='Data/GRANITE.csv')
hawaiite <- read.csv(file='Data/HAWAIITE.csv')
kimberlite <- read.csv(file='Data/KIMBERLITE.csv')
peridotite <-read.csv(file='Data/PERIDOTITE.csv')
pyroxenite <-read.csv(file='Data/PYROXENITE.csv')
rhyolite <-read.csv(file='Data/RHYOLITE.csv')
ref <- read.csv(file='Data/Normalised Values.csv')
# gathering REE data from sample
ree_sample1 <- as.numeric(adakite[19, 119:132])
ree_sample2 <- as.numeric(alkali_basalt[20, 119:132])
ree_sample3 <- as.numeric(andesite[7, 119:132])
ree_sample4 <- as.numeric(anakaramite[80, 119:132])
ree_sample5 <- as.numeric(basalt[20, 119:132])
ree_sample6 <- as.numeric(dolerite[20, 119:132])
ree_sample7 <- as.numeric(gabbro[20, 119:132])
ree_sample8 <- as.numeric(granite[20, 119:132])
ree_sample9 <- as.numeric(hawaiite[19, 119:132])
ree_sample10 <- as.numeric(kimberlite[20, 119:132])
ree_sample11 <- as.numeric(peridotite[10, 119:132])
ree_sample12 <- as.numeric(pyroxenite[20, 119:132])
ree_sample13 <- as.numeric(rhyolite[20, 119:132])
# taking reference values
ree_ref <- as.numeric(ref[3:16, 14]) #column 4,5 dont work
colors <- c("black","red","yellow","lightblue","green","orange","pink","cyan","purple","brown","gold","violet","navy")
rock_names <- c("adakite","alkali_basalt","andesite","anakaramite","basalt","dolerite","gabbro","granite","hawaiite","kimberlite","peridotite","pyroxenite","rhyolite")
#this is a function for plotting spider plots for REE data
plot_spider <- function(samples,reference_values,logscale=TRUE,colors=NULL,main= "Spider Plot for Normalised REE Values",xlab="Rare Earth Elements",ylab ="Normalised values")
{
# these are the REE we will be covering generally
REE_symbols <-  c("La","Ce","Pr","Nd","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu")
if (is.null(colors))
{
colors <- c("black","red","yellow","lightblue","green","orange","pink","cyan","purple","brown","gold","violet","navy")
}
# normalising values of samples with the reference set
normalised_values <- lapply(samples,function(s1) as.numeric(s1)/as.numeric(reference_values))
#axis range
ymin <- if (logscale) min(unlist(normalised_values), na.rm = TRUE) else 0
ymax <- max(unlist(normalised_values), na.rm = TRUE)
# generate plot
plot(1:length(reference_values),normalised_values[[1]],type="b",xaxt="n",,xlab="Rare Earth Elements",ylab ="Concentration",log = 'y',ylim = c(ymin, ymax),col=colors[1])
axis(1,at=1:length(reference_values),labels = REE_symbols)
grid(nx=NULL, ny=NULL,col="gray",lwd=1)
abline(h=1,col="black",lwd=3)
# generate other plots
if(length(normalised_values)>1)
{
for(i in 2:length(normalised_values))
{
lines(1:length(reference_values),normalised_values[[i]],type="b",col=colors[i])
}
}
legend("right", legend = rock_names, col = colors[1:length(samples)], lty = 1, lwd = 2, bty = "n")
}
samples <- list(ree_sample1,ree_sample2,ree_sample3,ree_sample4,ree_sample5,ree_sample6,ree_sample7,ree_sample8,ree_sample9,ree_sample10,ree_sample11,ree_sample12,ree_sample13)
plot_spider(samples, ree_ref,main = "REE Spider Diagram (Sample 19, Reference: m&s )")
setwd("~/Desktop/MSci Project /RareEarthElements")
